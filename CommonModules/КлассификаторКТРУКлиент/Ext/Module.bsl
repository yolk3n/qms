#Область ПрограммныйИнтерфейс

#Область УстаревшиеПроцедурыИФункции

// Устарела. Следует использовать ФайловаяСистемаКлиент.ЗагрузитьФайл.
// Вызывает диалог выбора файла
//
// Параметры:
//  Оповещение                  - ОписаниеОповещения - описание процедуры, которая будет вызвана после закрытия формы выбора файла
//  НачальноеПолноеИмяФайла     - Строка - начальный путь к файлу или пустая строка
//  Фильтр                      - Строка - Содержит строку с набором файловых фильтров.
//                                         Пример строки: "Текстовый документ(*.txt)|*.txt|Табличный документ(*.mxl)|*.mxl"
//  Заголовок                   - Строка - Заголовок диалога выбора файла
//  МножественныйВыбор          - Булево
//  ПроверятьСуществованиеФайла - Булево
//
Процедура ВыбратьФайлСКонтролемРасширенияРаботыСФайлами(Оповещение, ИмяФайла = "", Фильтр = "", Заголовок = Неопределено, МножественныйВыбор = Ложь, ТолькоСуществующие = Ложь) Экспорт
	
	ОповещениеПослеКонтроля = Новый ОписаниеОповещения("ВыбратьФайлЗавершениеКонтроляРасширенияРаботыСФайлами", ЭтотОбъект, Новый Структура);
	ОповещениеПослеКонтроля.ДополнительныеПараметры.Вставить("ИмяФайла", ИмяФайла);
	ОповещениеПослеКонтроля.ДополнительныеПараметры.Вставить("Фильтр", Фильтр);
	ОповещениеПослеКонтроля.ДополнительныеПараметры.Вставить("Заголовок", Заголовок);
	ОповещениеПослеКонтроля.ДополнительныеПараметры.Вставить("МножественныйВыбор", МножественныйВыбор);
	ОповещениеПослеКонтроля.ДополнительныеПараметры.Вставить("ПроверятьСуществованиеФайла", ТолькоСуществующие);
	ОповещениеПослеКонтроля.ДополнительныеПараметры.Вставить("Оповещение", Оповещение);
	
	ФайловаяСистемаКлиент.ПодключитьРасширениеДляРаботыСФайлами(ОповещениеПослеКонтроля,, Ложь);
	
КонецПроцедуры

// Устарела. Следует использовать ФайловаяСистемаКлиент.ЗагрузитьФайл.
// Завершение немодального контроля расширения работы с файлами перед выбором файла
//
Процедура ВыбратьФайлЗавершениеКонтроляРасширенияРаботыСФайлами(Подключено, ДополнительныеПараметры) Экспорт
	
	Если Не Подключено Тогда
		ВыполнитьОбработкуОповещения(ДополнительныеПараметры.Оповещение, Неопределено);
		Возврат;
	КонецЕсли;
	
	ДиалогВыбораФайла = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);
	ДиалогВыбораФайла.Заголовок = ДополнительныеПараметры.Заголовок;
	ДиалогВыбораФайла.Фильтр = ДополнительныеПараметры.Фильтр;
	ДиалогВыбораФайла.МножественныйВыбор = ДополнительныеПараметры.МножественныйВыбор;
	ДиалогВыбораФайла.ПроверятьСуществованиеФайла = ДополнительныеПараметры.ПроверятьСуществованиеФайла;
	
	НачальноеПолноеИмяФайла = ДополнительныеПараметры.ИмяФайла;
	Если Не ПустаяСтрока(НачальноеПолноеИмяФайла) Тогда
		Если Прав(НачальноеПолноеИмяФайла, 1) = "\" Или Прав(НачальноеПолноеИмяФайла, 1) = "/" Тогда
			ДиалогВыбораФайла.Каталог = НачальноеПолноеИмяФайла;
		Иначе
			ДиалогВыбораФайла.ПолноеИмяФайла = НачальноеПолноеИмяФайла;
		КонецЕсли;
	КонецЕсли;
	
	ДиалогВыбораФайла.Показать(ДополнительныеПараметры.Оповещение)
	
КонецПроцедуры

#КонецОбласти

#КонецОбласти