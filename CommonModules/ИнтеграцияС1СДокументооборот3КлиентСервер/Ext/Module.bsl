////////////////////////////////////////////////////////////////////////////////
// Подсистема "Интеграция с 1С:Документооборотом"
// Модуль ИнтеграцияС1СДокументооборот3КлиентСервер: клиент, сервер
////////////////////////////////////////////////////////////////////////////////

#Область ПрограммныйИнтерфейс

// Конструктор структуры, описывающей задачу.
//
// Параметры:
//   ID - Строка - идентификатор задачи Документооборота.
//   Тип - Строка - XDTO-тип задачи Документооборота.
//   Заголовок - Строка - заголовок задачи.
//
// Возвращаемое значение:
//   Структура:
//     * ДействиеЗадачи - см. ИнтеграцияС1СДокументооборотБазоваяФункциональностьКлиентСервер.ДанныеСсылочногоОбъектаДО
//     * Новое - Булево
//     * Просрочено - Булево
//     * ПредставлениеHTML - Строка
//     * АдресДополнительныхДанных - Строка
//     * Флаг - Строка
//     * РезультатДействия - см. ИнтеграцияС1СДокументооборотБазоваяФункциональностьКлиентСервер.ДанныеСсылочногоОбъектаДО
//     * РезультатДействияТекстом - Строка
//     * ВерсияДанныхДействияЗадачи - Строка
//
Функция ДанныеПоЗадаче(ID, Тип, Заголовок = "") Экспорт
	
	ДанныеПоЗадаче = Новый Структура;
	ДанныеПоЗадаче.Вставить("ДействиеЗадачи",
		ИнтеграцияС1СДокументооборотБазоваяФункциональностьКлиентСервер.ДанныеСсылочногоОбъектаДО(ID, Тип, Заголовок));
	ДанныеПоЗадаче.Вставить("Новое", Ложь);
	ДанныеПоЗадаче.Вставить("Просрочено", Ложь);
	ДанныеПоЗадаче.Вставить("ПредставлениеHTML", "");
	ДанныеПоЗадаче.Вставить("АдресДополнительныхДанных", "");
	ДанныеПоЗадаче.Вставить("Флаг", "");
	ДанныеПоЗадаче.Вставить("РезультатДействия",
		ИнтеграцияС1СДокументооборотБазоваяФункциональностьКлиентСервер.ДанныеСсылочногоОбъектаДО("", ""));
	ДанныеПоЗадаче.Вставить("РезультатДействияТекстом", "");
	ДанныеПоЗадаче.Вставить("ВерсияДанныхДействияЗадачи", "");
	
	Возврат ДанныеПоЗадаче;
	
КонецФункции

// Список колонок таблицы "Быстрый поиск", подлежащие заполнению.
//
// Возвращаемое значение:
//   Строка
//
Функция КолонкиБыстрогоПоиска() Экспорт
	
	Возврат "Параметр, Значение, ЗначениеID, ЗначениеТип, ПредставлениеПараметра, Тип, ПредставлениеЗначения,
		|Фиксированный, ЗначениеПоУмолчанию, ЗначениеПоУмолчаниюID, ЗначениеПоУмолчаниюТип";
	
КонецФункции

// Перерисовывает на форме список кнопок переключения страниц динамического списка.
//
// Параметры:
//   Форма - ФормаКлиентскогоПриложения - форма, на которой находится динамический список.
//   ТекущаяСтраница - Число - номер текущей страницы.
//   ВсегоСтраниц - Число - максимальное количество страниц.
//
Процедура ОбновитьКнопкиДинамическогоСписка(Форма, ТекущаяСтраница, ВсегоСтраниц) Экспорт
	
	Если ТекущаяСтраница > ВсегоСтраниц Тогда
		ТекущаяСтраница = ВсегоСтраниц;
	КонецЕсли;
	
	Если ВсегоСтраниц = 1 Тогда
		Форма.Элементы.ПереключениеСтраниц.Видимость = Ложь;
		Возврат;
	Иначе
		Форма.Элементы.ПереключениеСтраниц.Видимость = Истина;
	КонецЕсли;
	
	Если (ВсегоСтраниц > 1) И (ВсегоСтраниц < 9) Тогда
		
		Для НомерКнопки = 1 По ВсегоСтраниц Цикл
			Форма.Элементы["Страница" + НомерКнопки].Видимость = Истина;
		КонецЦикла;
		Для НомерКнопки = (ВсегоСтраниц + 1) По 9 Цикл
			Форма.Элементы["Страница" + НомерКнопки].Видимость = Ложь;
		КонецЦикла;
		
	Иначе
		
		Для НомерКнопки = 1 По 9 Цикл
			Форма.Элементы["Страница" + НомерКнопки].Видимость = Истина;
		КонецЦикла;
		
	КонецЕсли;
	
	ЕстьПревышение = (ВсегоСтраниц > 9);
	ЕстьЛеваяКнопкаВыбора = ЕстьПревышение И (ТекущаяСтраница > 5);
	ЕстьПраваяКнопкаВыбора = ЕстьПревышение И (ТекущаяСтраница < (ВсегоСтраниц - 4));
	
	Если ЕстьЛеваяКнопкаВыбора Тогда
		Форма.Элементы.Страница2.Заголовок = "...";
	Иначе
		Форма.Элементы.Страница2.Заголовок = "2";
	КонецЕсли;
	
	Если ЕстьЛеваяКнопкаВыбора И ЕстьПраваяКнопкаВыбора Тогда
		
		ТекущаяКнопка = 5;
		Форма.Элементы.Страница3.Заголовок = ТекущаяСтраница - 2;
		Форма.Элементы.Страница4.Заголовок = ТекущаяСтраница - 1;
		Форма.Элементы.Страница5.Заголовок = ТекущаяСтраница;
		Форма.Элементы.Страница6.Заголовок = ТекущаяСтраница + 1;
		Форма.Элементы.Страница7.Заголовок = ТекущаяСтраница + 2;
		
	ИначеЕсли ЕстьЛеваяКнопкаВыбора Тогда
		
		ТекущаяКнопка = 9 - (ВсегоСтраниц - ТекущаяСтраница);
		Форма.Элементы.Страница3.Заголовок = ВсегоСтраниц - 6;
		Форма.Элементы.Страница4.Заголовок = ВсегоСтраниц - 5;
		Форма.Элементы.Страница5.Заголовок = ВсегоСтраниц - 4;
		Форма.Элементы.Страница6.Заголовок = ВсегоСтраниц - 3;
		Форма.Элементы.Страница7.Заголовок = ВсегоСтраниц - 2;
		Форма.Элементы.Страница8.Заголовок = ВсегоСтраниц - 1;
		
	Иначе
		
		ТекущаяКнопка = ТекущаяСтраница;
		Форма.Элементы.Страница3.Заголовок = "3";
		Форма.Элементы.Страница4.Заголовок = "4";
		Форма.Элементы.Страница5.Заголовок = "5";
		Форма.Элементы.Страница6.Заголовок = "6";
		Форма.Элементы.Страница7.Заголовок = "7";
		Форма.Элементы.Страница8.Заголовок = "8";
		
	КонецЕсли;
	
	Если ЕстьПраваяКнопкаВыбора Тогда
		Форма.Элементы.Страница8.Заголовок = "...";
	КонецЕсли;
	
	Форма.Элементы.Страница9.Заголовок = ВсегоСтраниц;
	
	Для НомерКнопки = 1 По 9 Цикл
		Форма.Элементы["Страница" + НомерКнопки].Пометка = (НомерКнопки = ТекущаяКнопка);
	КонецЦикла;
	
	Форма.Элементы.Назад.Доступность = (ТекущаяСтраница > 1);
	Форма.Элементы.Вперед.Доступность = (ТекущаяСтраница < ВсегоСтраниц);
	
КонецПроцедуры

// Конструктор структуры, описывающей параметры формы списка задач.
//
// Возвращаемое значение:
//   Структура:
//     * ТекущаяСтраница - Число
//     * РазмерСтраницыДинамическогоСписка - Число
//     * ПолеДляСортировки - Строка
//     * НаправлениеСортировкиПоля - Строка
//     * Фильтры - СписокЗначений
//     * БыстрыйПоиск - ТаблицаЗначений
//     * ОтображениеКарточкиЗадачи - ПеречислениеСсылка.ВариантыОтображенияОбластиЧтения
//
Функция ПараметрыФормыСпискаЗадач() Экспорт
	
	ПараметрыФормыСпискаЗадач = Новый Структура;
	ПараметрыФормыСпискаЗадач.Вставить("ТекущаяСтраница", 0);
	ПараметрыФормыСпискаЗадач.Вставить("РазмерСтраницыДинамическогоСписка", 0);
	ПараметрыФормыСпискаЗадач.Вставить("ПолеДляСортировки", "");
	ПараметрыФормыСпискаЗадач.Вставить("НаправлениеСортировкиПоля", Ложь);
	ПараметрыФормыСпискаЗадач.Вставить("Фильтры", Новый СписокЗначений);
	ПараметрыФормыСпискаЗадач.Вставить("БыстрыйПоиск", Неопределено);
	ПараметрыФормыСпискаЗадач.Вставить("ОтображениеКарточкиЗадачи",
		ПредопределенноеЗначение("Перечисление.ВариантыОтображенияОбластиЧтения.ПустаяСсылка"));
	
	Возврат ПараметрыФормыСпискаЗадач;
	
КонецФункции

// Возвращает представление типа объекта XDTO Документооборота по имени типа.
//
// Параметры:
//   ТипXDTO - Строка - имя типа объекта XDTO.
//   Режим - Строка - принимает значения: "ЕдинственноеЧисло", "МножественноеЧисло", "ЗаголовокФормыВыбора".
//
// Возвращаемое значение:
//   Строка - представление типа объекта XDTO Документооборота по имени типа.
//
Функция ПредставлениеТипаОбъектаXDTO(ТипXDTO, Режим = "МножественноеЧисло") Экспорт
	
	ПредставленияТипов = Новый Соответствие;
	
	ДобавитьПредставленияСправочников(Режим, ПредставленияТипов);
	ДобавитьПредставленияПеречислений(Режим, ПредставленияТипов);
	ДобавитьПредставленияБизнесПроцессовИШаблонов(Режим, ПредставленияТипов);
	
	ПредставлениеТипа = ПредставленияТипов.Получить(ТипXDTO);
	
	Если ЗначениеЗаполнено(ПредставлениеТипа) Тогда
		Возврат ПредставлениеТипа;
	Иначе
		Возврат ТипXDTO;
	КонецЕсли;
	
КонецФункции

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

Процедура ДобавитьПредставленияБизнесПроцессовИШаблонов(Режим, ПредставленияТипов)
	
	// Шаблоны бизнес-процессов.
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Шаблон рассмотрения'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор шаблона рассмотрения'");
	Иначе
		Представление = НСтр("ru='Шаблоны рассмотрения'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMBusinessProcessConsiderationTemplate", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Шаблон регистрации'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор шаблона регистрации'");
	Иначе
		Представление = НСтр("ru='Шаблоны регистрации'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMBusinessProcessRegistrationTemplate", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Шаблон согласования'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор шаблона согласования'");
	Иначе
		Представление = НСтр("ru='Шаблоны согласования'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMBusinessProcessApprovalTemplate", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Шаблон утверждения'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор шаблона утверждения'");
	Иначе
		Представление = НСтр("ru='Шаблоны утверждения'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMBusinessProcessConfirmationTemplate", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Шаблон исполнения'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор шаблона исполнения'");
	Иначе
		Представление = НСтр("ru='Шаблоны исполнения'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMBusinessProcessPerformanceTemplate", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Шаблон ознакомления'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор шаблона ознакомления'");
	Иначе
		Представление = НСтр("ru='Шаблоны ознакомления'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMBusinessProcessAcquaintanceTemplate", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Шаблон приглашения'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор шаблона приглашения'");
	Иначе
		Представление = НСтр("ru='Шаблоны приглашения'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMBusinessProcessInvitationTemplate", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Шаблон комплексного процесса'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор шаблона комплексного процесса'");
	Иначе
		Представление = НСтр("ru='Шаблоны комплексных процессов'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMComplexBusinessProcessTemplate", Представление);
	
	// Бизнес-процессы.
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Рассмотрение'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор рассмотрения'");
	Иначе
		Представление = НСтр("ru='Рассмотрения'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMBusinessProcessConsideration", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Регистрация'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор регистрации'");
	Иначе
		Представление = НСтр("ru='Регистрации'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMBusinessProcessRegistration", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Согласование'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор согласования'");
	Иначе
		Представление = НСтр("ru='Согласования'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMBusinessProcessApproval", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Утверждение'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор утверждения'");
	Иначе
		Представление = НСтр("ru='Утверждения'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMBusinessProcessConfirmation", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Исполнение'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор исполнения'");
	Иначе
		Представление = НСтр("ru='Исполнения'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMBusinessProcessPerformance", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Ознакомление'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор ознакомления'");
	Иначе
		Представление = НСтр("ru='Ознакомления'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMBusinessProcessAcquaintance", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Решение вопросов'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор решения вопросов'");
	Иначе
		Представление = НСтр("ru='Решения вопросов'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMBusinessProcessIssuesSolution", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Приглашение'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор приглашения'");
	Иначе
		Представление = НСтр("ru='Приглашения'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMBusinessProcessInvitation", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Комплексный процесс'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор комплексного процесса'");
	Иначе
		Представление = НСтр("ru='Комплексные процессы'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMComplexBusinessProcess", Представление);
	
КонецПроцедуры

Процедура ДобавитьПредставленияПеречислений(Режим, ПредставленияТипов)
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Тип ответа'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор типа ответа'");
	Иначе
		Представление = НСтр("ru='Типы ответа'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMEMailAnswerType", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Вид вопросов выполнения задач'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор вида вопросов выполнения задач'");
	Иначе
		Представление = НСтр("ru='Виды вопросов выполнения задач'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMIssueType", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Порядок продления'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор порядка продления'");
	Иначе
		Представление = НСтр("ru='Порядки продления'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMProlongationProcedure", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Состояние документа'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор состояния документа'");
	Иначе
		Представление = НСтр("ru='Состояния документов'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMDocumentStatus", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Состояние мероприятия'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор состояния мероприятия'");
	Иначе
		Представление = НСтр("ru='Состояния мероприятий'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMMeetingStatus", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Состояние протокола мероприятия'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор состояния протокола мероприятия'");
	Иначе
		Представление = НСтр("ru='Состояния протоколов мероприятий'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMMeetingMinutesItemStatus", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Юридическое\физическое лицо'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор юр\физ лица'");
	Иначе
		Представление = НСтр("ru='Юридическое\физическое лица'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMLegalPrivatePerson", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Ставка НДС'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор ставки НДС'");
	Иначе
		Представление = НСтр("ru='Ставки НДС'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMVATRate", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Вариант подписания'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор варианта подписания'");
	Иначе
		Представление = НСтр("ru='Варианты подписания'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMSignatureOption", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Тип контактной информации'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор типа контактной информации'");
	Иначе
		Представление = НСтр("ru='Типы контактной информации'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMContactInformationType", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Категория дел'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор категории дел'");
	Иначе
		Представление = НСтр("ru='Категории дел'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMCategoriesOfCases", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='День недели'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор дня недели'");
	Иначе
		Представление = НСтр("ru='Дни недели'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMDaysOfTheWeek", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Вид дня'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор вида дня'");
	Иначе
		Представление = НСтр("ru='Виды дней'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMKindsOfDays", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Политика учета рабочего времени'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор политики учета рабочего времени'");
	Иначе
		Представление = НСтр("ru='Политики учета рабочего времени'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMTimeTrackingPolicy", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Тип ответа'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор типа ответа'");
	Иначе
		Представление = НСтр("ru='Типы ответа'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMIncomingEMailAnswerType", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Состояние приглашения'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор состояния приглашения'");
	Иначе
		Представление = НСтр("ru='Состояния приглашения'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMInvitationStatus", Представление);
	
КонецПроцедуры

Процедура ДобавитьПредставленияСправочников(Режим, ПредставленияТипов)
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Контрагент, Организация, Пользователь'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор стороны'");
	Иначе
		Представление = НСтр("ru='Контрагенты, Организации, Пользователи'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMParty", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Проект'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор проекта'");
	Иначе
		Представление = НСтр("ru='Проекты'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMProject", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Проектная задача'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор проектной задачи'");
	Иначе
		Представление = НСтр("ru='Проектные задачи'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMProjectTask", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Тема обсуждения'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор темы обсуждений'");
	Иначе
		Представление = НСтр("ru='Темы обсуждений'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMDiscussionTopic", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Сообщение обсуждения'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор сообщения обсуждений'");
	Иначе
		Представление = НСтр("ru='Сообщения обсуждений'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMDiscussionMessage", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Файл'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор файла'");
	Иначе
		Представление = НСтр("ru='Файлы'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMFile", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Папка файлов'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор папки файлов'");
	Иначе
		Представление = НСтр("ru='Папки файлов'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMFileFolder", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Папка документов'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор папки документов'");
	Иначе
		Представление = НСтр("ru='Папки документов'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMDocumentFolder", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Папка мероприятий'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор папки мероприятий'");
	Иначе
		Представление = НСтр("ru='Папки мероприятий'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMMeetingFolder", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Пользователь'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор пользователя'");
	Иначе
		Представление = НСтр("ru='Пользователи'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMUser", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Группа пользователей'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор группы пользователей'");
	Иначе
		Представление = НСтр("ru='Группы пользователей'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMUserGroup", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Сотрудник'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор сотрудника'");
	Иначе
		Представление = НСтр("ru='Сотрудники'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMEmployee", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Вопрос деятельности'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор вопроса деятельности'");
	Иначе
		Представление = НСтр("ru='Вопросы деятельности'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMActivityMatter", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Валюта'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор валюты'");
	Иначе
		Представление = НСтр("ru='Валюты'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMCurrency", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Документ'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор документа'");
	Иначе
		Представление = НСтр("ru='Документы'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMDocument", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Мероприятие'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор мероприятия'");
	Иначе
		Представление = НСтр("ru='Мероприятия'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMMeeting", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Организация'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор организации'");
	Иначе
		Представление = НСтр("ru='Организации'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMOrganization", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Контрагент'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор контрагента'");
	Иначе
		Представление = НСтр("ru='Контрагенты'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMCorrespondent", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Контактное лицо'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор контактного лица'");
	Иначе
		Представление = НСтр("ru='Контактные лица'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMContactPerson", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Гриф доступа'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор грифа доступа'");
	Иначе
		Представление = НСтр("ru='Грифы доступа'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMAccessLevel", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Способ доставки'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор способа доставки'");
	Иначе
		Представление = НСтр("ru='Способы доставки'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMDeliveryMethod", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Подразделение'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор подразделения'");
	Иначе
		Представление = НСтр("ru='Подразделения'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMSubdivision", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Вид документа'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор вида документов'");
	Иначе
		Представление = НСтр("ru='Виды документов'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMDocumentType", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Вид мероприятия'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор вида мероприятия'");
	Иначе
		Представление = НСтр("ru='Виды мероприятий'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMMeetingType", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Вид работ'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор вида работ'");
	Иначе
		Представление = НСтр("ru='Виды работ'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMWorkType", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Тип связей'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор типа связей'");
	Иначе
		Представление = НСтр("ru='Типы связей'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMRelationType", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Значение свойств объектов'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор значения свойств объектов'");
	Иначе
		Представление = НСтр("ru='Значения свойств объектов'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMObjectPropertyValue", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Физическое лицо'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор физического лица'");
	Иначе
		Представление = НСтр("ru='Физические лица'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMPrivatePerson", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Условие маршрутизации'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор условия маршрутизации'");
	Иначе
		Представление = НСтр("ru='Условия маршрутизации'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMRoutingCondition", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Личный адресат'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор личного адресата'");
	Иначе
		Представление = НСтр("ru='Личные адресаты'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMPersonalRecipient", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Группа личных адресатов'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор группы личных адресатов'");
	Иначе
		Представление = НСтр("ru='Группы личных адресатов'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMPersonalRecipientGroup", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Роль исполнителя'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор роли исполнителей'");
	Иначе
		Представление = НСтр("ru='Роли исполнителей'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMBusinessProcessExecutorRole", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Статья движения денежных средств'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор статьи движения денежных средств'");
	Иначе
		Представление = НСтр("ru='Статьи движения денежных средств'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMCashFlowItem", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Единица измерения'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор единицы измерения'");
	Иначе
		Представление = НСтр("ru='Единицы измерения'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMMeasurementUnit", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Товар, услуга'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор номенклатуры'");
	Иначе
		Представление = НСтр("ru='Товары и услуги'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMProduct", Представление);
	
	Если Режим = "ЕдинственноеЧисло" Тогда
		Представление = НСтр("ru='Дополнительный реквизит / сведение'");
	ИначеЕсли Режим = "ЗаголовокФормыВыбора" Тогда
		Представление = НСтр("ru='Выбор дополнительного реквизита'");
	Иначе
		Представление = НСтр("ru='Дополнительные реквизиты и сведения'");
	КонецЕсли;
	ПредставленияТипов.Вставить("DMAdditionalProperty", Представление);
	
КонецПроцедуры

#КонецОбласти