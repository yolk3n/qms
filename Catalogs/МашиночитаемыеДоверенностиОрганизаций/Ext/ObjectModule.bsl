#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ОбработчикиСобытий

Процедура ПередЗаписью(Отказ)
	
	Если ОбменДанными.Загрузка Тогда
		Возврат;
	КонецЕсли;
	
	ОбновлениеИнформационнойБазы.ПроверитьОбъектОбработан(ЭтотОбъект);
	
	МЧД = Справочники.МашиночитаемыеДоверенностиОрганизаций.НайтиПоРеквизиту("НомерДоверенности", НомерДоверенности);
	
	Если ЗначениеЗаполнено(МЧД) И Ссылка <> МЧД Тогда
		
		ДополнительныеСвойства.Вставить("МЧД", МЧД);
		ТекстСообщения = НСтр("ru = 'Доверенность с таким номером уже существует'") + ": " + НомерДоверенности;
		ОбщегоНазначения.СообщитьПользователю(ТекстСообщения);
		ВызватьИсключение ТекстСообщения;
		
	КонецЕсли;
	
	Наименование = МашиночитаемыеДоверенности.ПредставлениеОбъекта(ЭтотОбъект);
	
	Если НЕ ЗначениеЗаполнено(СведенияОбИнформационнойСистеме) Тогда
		СведенияОбИнформационнойСистеме = МашиночитаемыеДоверенности.СведенияОбИнформационнойСистеме();
	КонецЕсли;
	
	Если Не ЗначениеЗаполнено(ДатаСоздания) Тогда
		ДатаСоздания = ТекущаяДатаСеанса();
	КонецЕсли;
	
	Если Отозвана И Не ЗначениеЗаполнено(ДатаОтзыва) Тогда
		ДатаОтзыва = ТекущаяДатаСеанса();
	КонецЕсли;
	
	Если Не Отозвана И ЗначениеЗаполнено(ДатаОтзыва) Тогда
		ДатаОтзыва = Дата(1, 1, 1);	
	КонецЕсли;
	
	Если Верна И Не Подписана Тогда
		Верна = Ложь;	
	КонецЕсли;
	
КонецПроцедуры

Процедура ПриКопировании(ОбъектКопирования)

	Отозвана = Ложь;
	ДатаОтзыва = Дата(1, 1, 1);
	ДатаВыдачи = Дата(1, 1, 1);
	ДатаОкончания = Дата(1, 1, 1);
	
	Для Каждого Полномочие Из Полномочия Цикл 
		
		КодПолномочий = Полномочие.Код;
		ОписаниеПолномочий = Полномочие.Описание;
		СодержаниеПолномочий = Полномочие.Содержание;
		
		Если ЗначениеЗаполнено(КодПолномочий) И ЗначениеЗаполнено(СодержаниеПолномочий)
			И Не ЗначениеЗаполнено(ОписаниеПолномочий) Тогда
			ШаблонОписания = ("%1; %2"); 
			ОписаниеПолномочий = СтрШаблон(ШаблонОписания, КодПолномочий, СодержаниеПолномочий);
			КодПолномочий = "";
			СодержаниеПолномочий = "";
		КонецЕсли;

		Полномочие.Код = КодПолномочий;
		Полномочие.Содержание = СодержаниеПолномочий;
		Полномочие.Описание = ОписаниеПолномочий;
		
	КонецЦикла;	
	
КонецПроцедуры

#КонецОбласти

#КонецЕсли